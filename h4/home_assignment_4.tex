\documentclass[12pt]{article}

\usepackage[a4paper]{geometry} %page size
\usepackage{parskip} %no paragraph indentation
\usepackage{fancyhdr} %fancy stuff in page header
\pagestyle{fancy} 

\usepackage[utf8]{inputenc} %encoding
\usepackage[danish]{babel} %danish letters

\usepackage{graphicx} %import pictures

\usepackage{amsmath, amssymb, amsfonts, amsthm, mathtools} %doing math
\usepackage{algorithmicx, algpseudocode} %doing pseudocode,

\fancyhead{}
\lhead{Machine Learning: Home Assignment 4}
\rhead{Asger Andersen}

%End of preamble
%*******************************************************************************

\begin{document}

\section{The growth function}

\input{some_section.tex}

\textbf{Question 1:} Let $\mathcal{H}$ be any hypothesis set, where $h:\mathcal{X}\to \{-1,1\}$ for all $h\in \mathcal{H}$. Abu-Mostafa 2015 defines that
\begin{align}
\mathcal{H}(x_1,...,x_N) = \{(h(x_1),...,h(x_N))\ |\ h\in \mathcal{H}\}
\end{align}
for specific $x_1,...,x_N \in \mathcal{X}$, and further defines the growth function $m_\mathcal{H}:\mathbb{N}\to \mathbb{N}$ as
\begin{align}
m_\mathcal{H}(N) = \max_{x_1,...,x_N \in \mathcal{X}} |\mathcal{H}(x_1,...,x_N)|
\end{align}

Since $h(x)\in\{-1,1 \}$ for all $h\in \mathcal{H}$ and $x\in \mathcal{X}$, we must have for all $N\in \mathbb{N}$ and all $x_1,...,x_N \in \mathcal{X}$:
\begin{align}
\mathcal{H}(x_1,...,x_N) \subset \{-1,1 \}^N = \{(y_1,...,y_N)\ |\ y_1,...,y_N \in \{-1, 1 \} \}
\end{align}
which implies that for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq |\{-1,1 \}^N | = 2^N 
\end{align}
This is true whether or not $\mathcal{H}$ is finite or infinite. 

If we now assume that $\mathcal{H}$ is finite with $\mathcal{H} = \{h_1,...,h_M\}$, then we get that for all $N\in \mathbb{N}$ and all $x_1,...,x_N \in \mathcal{X}$:
\begin{align}
\mathcal{H}(x_1,...,x_N) = \{(h_i(x_1),...,h_i(x_N))\ |\ i\in \{1,...,M \}\}
\end{align}
which implies that for all $N\in \mathbb{N}$ and all $x_1,...,x_N \in \mathcal{X}$:
\begin{align}
|\mathcal{H}(x_1,...,x_N)| \leq M
\end{align}
which implies that for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq M 
\end{align}
By line (1) and (7) we now have that for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq \min (M,2^N)
\end{align}

\textbf{Question 2:} Let $\mathcal{H}$ be any hypothesis set, where $h:\mathcal{X}\to \{-1,1\}$ for all $h\in \mathcal{H}$. Define the shattered sample sizes $\mathcal{N}_\mathcal{H}$ for $\mathcal{H}$ as:
\begin{align}
\mathcal{N}_\mathcal{H} = \{ N\in \mathbb{N}\ |\ m_\mathcal{H}(N) = 2^N \}
\end{align}
We can now rewrite Abu-Mostafa 2015's definition of the VC-dimension $d_{VC}$ of $\mathcal{H}$ as
\begin{align}
d_{VC}(\mathcal{H}) = \max \mathcal{N}_\mathcal{H}
\end{align}
where
\begin{align}
\max \mathcal{N}_\mathcal{H} = \infty
\end{align}
if $\mathcal{N}_\mathcal{H} = \mathbb{N}$.

Assume that $\mathcal{H}$ is finite with $|\mathcal{H}|=M$. Let me now proof that for all $N \in \mathcal{N}_\mathcal{H}$:
\begin{align}
N \leq \log_2 M
\end{align}
Assume that $N \in \mathcal{N}_\mathcal{H}$. By definition of $\mathcal{N}_\mathcal{H}$ we now have that
\begin{align}
m_\mathcal{H}(N)=2^N 
\end{align}
Since $|\mathcal{H}|=M$, we know from question 1 that
\begin{align}
m_\mathcal{H}(N)=\min(M, 2^N) 
\end{align}
From combining line (13) and (14), we now get that
\begin{align}
2^N \leq M 
\end{align}
which implies that
\begin{align}
N \leq \log_2M
\end{align}
I have now proven that for all $N \in \mathcal{N}_\mathcal{H}$:
\begin{align}
N \leq \log_2 M
\end{align}
This clearly means that 
\begin{align}
d_{VC}(\mathcal{H}) = \max \mathcal{N}_\mathcal{H} \leq \log_2 M
\end{align}
I have now proven that for all hypothesis sets $\mathcal{H}$, where $h:\mathcal{X}\to \{-1,1\}$ for all $h\in \mathcal{H}$ and $|\mathcal{H}|=M$, we have that
\begin{align}
d_{VC}(\mathcal{H}) \leq \log_2 M
\end{align}

\textbf{Question 3:} Let $\mathcal{H}$ be any hypothesis set, where $h:\mathcal{X}\to \{-1,1\}$ for all $h\in \mathcal{H}$. As I argued in question 1, we have that for all $N \in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq 2^N
\end{align}
which implies that for all $N \in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(2N) \leq 2^{2N} = \left(2^N\right)^2
\end{align}
which together with line (20) implies that for all $N \in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq \left( m_\mathcal{H}(N) \right)^2
\end{align}

\textbf{Question 4:} NOT SOLVED YET.

\textbf{Question 5:} Let $\mathcal{H}$ be any hypothesis set, where $h:\mathcal{X}\to \{-1,1\}$ for all $h\in \mathcal{H}$. Theorem 2.4 in Abu-Mostafa 2015 states that if $m_\mathcal{H}(d) < 2^d$ for some $d \in \mathbb{N}$, then for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq \sum_{i=0}^{d-1} \binom{N}{i}
\end{align}
From this and question 4, it directly follows that if $m_\mathcal{H}(k) < 2^d$ for some $d \in \mathbb{N}$, then for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq N^{d-1} + 1
\end{align}

\textbf{Question 6:} Let $\mathcal{H}$ be any hypothesis set, where $h:\mathcal{X}\to \{-1,1\}$ for all $h\in \mathcal{H}$, and assume that there exists some $d\in \mathbb{N}$ such that $m_\mathcal{H}(d) < 2^d$. From question 1, we know that for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq 2^N
\end{align}
From question 6, we know that for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq N^{d-1} + 1
\end{align}
Therefore, we get that for all $N\in \mathbb{N}$:
\begin{align}
m_\mathcal{H}(N) \leq \min (N^{d-1} + 1, 2^N)
\end{align}
Let $\mathcal{N}_\mathcal{H}$ be defined as in question 2, and assume that $N \in \mathcal{N}_\mathcal{H}$. By definition of $\mathcal{N}_\mathcal{H}$ we now have that
\begin{align}
m_\mathcal{H}(N)=2^N 
\end{align}
From combining line (XXXX) and (XXXX), we now get that
\begin{align}
2^N \leq N^{d-1} + 1
\end{align}
Define 
\begin{align}
A_d = \{N \ |\  2^N \leq N^{d-1} + 1\}
\end{align}
Line (XXXX - XXXX) proofs that
\begin{align}
\mathcal{N}_\mathcal{H}\subset A_d
\end{align}
which implies
\begin{align}
d_{VC}(\mathcal{H}) = \max \mathcal{N}_\mathcal{H} \leq \max A_d
\end{align}
If the numerical value of $A_d$ is of any interest, it can be found numerically for any $d$. $A_d$ is namely finite for any $d\in \mathbb{N}$, because the lefthand inequality defining $A_d$ is exponential, whereas the right hand side is polynomial.


\textbf{Question 7:} We see from the fact that the quantity
\begin{align}
\binom{N}{d-1}
\end{align}
must be meaningful in order for line (XXXX) in question 5 to be meaningful that $d-1\leq N$. If this is not the case and $d-1>N$, we also have that
\begin{align}
2^N \leq N^{d-1} + 1
\end{align}
is true for all $N \in \mathbb{N}$, which implies that
\begin{align}
A_d = \mathbb{N}
\end{align}
which implies that the bound on line (XXXX) turns into
\begin{align}
d_{VC}(\mathcal{H}) \leq \infty
\end{align}
which is not a very useful bound.

\section{VC-dimension}

\input{some_section.tex}

\section{Airline Revisited}

\input{some_section.tex}

\section{SVMs}

\input{some_section.tex}

\end{document}